USE CSDL;

SET DATEFORMAT mdy;

CREATE TABLE TRONG_TAI (
  MaTT CHAR(4) NOT NULL,
  HoDemTT NVARCHAR(255),
  TenTT NVARCHAR(255),
  NgaySinh DATE,
  QuocTich NVARCHAR(255),
  NamKinhNghiem INT,
  PRIMARY KEY (MaTT)
);


CREATE TABLE DOI_BONG (
  MaDB CHAR(4) NOT NULL,
  TenDB NVARCHAR(255),
  TenDB_VT CHAR,
  NamTLDB INT,
  MaSVD CHAR(5) NOT NULL,
  MaHLV CHAR(5) NOT NULL,
  PRIMARY KEY (MaDB)
);

CREATE TABLE DIA_DIEM (
  MaSVD CHAR(5) NOT NULL,
  TenSVD NVARCHAR(255),
  DiaChi NVARCHAR(255),
  Succhua INT,
  PRIMARY KEY (MaSVD)
);

CREATE TABLE HLV (
  MaHLV CHAR(5) NOT NULL,
  HoDemHLV NVARCHAR(255),
  TenHLV NVARCHAR(255),
  QuocTich NVARCHAR(255),
  NamKinhNghiem INT,
  PRIMARY KEY (MaHLV),
);

CREATE TABLE LICH_THI_DAU (
  MaLTD CHAR(6) NOT NULL,
  VongDau INT,
  NgayTD DATE,
  MaTD CHAR(5),
  MaGD CHAR(4),
  PRIMARY KEY (MaLTD),
);

CREATE TABLE GIAI_DAU (
  MaGD CHAR(4) NOT NULL,
  TenGD NVARCHAR(255),
  LoaiGD NVARCHAR(255),
  NamTC INT,
  ThoiGian NVARCHAR(255),
  SLTG INT,
  TheThuc NVARCHAR(255),
  PRIMARY KEY (MaGD)
);

CREATE TABLE CAU_THU (
  MaCT CHAR(5) NOT NULL,
  HoDemCT NVARCHAR(255),
  TenCT NVARCHAR(255),
  NgaySinh DATE,
  NoiSinh NVARCHAR(255),
  QuocTich NVARCHAR(255),
  ViTri NVARCHAR(255),
  ChieuCao INT,
  CanNang INT,
  SoAo INT,
  MaDB CHAR(4),
  PRIMARY KEY (MaCT)
);

CREATE TABLE NHA_TAI_TRO (
  TenNTT NVARCHAR(255),
  MaHDTT CHAR(6) NOT NULL,
  ThoiGianTT NVARCHAR(255),
  DichVuTT NVARCHAR(255),
  LienHe NVARCHAR(255),
  MaGD CHAR(4),
  PRIMARY KEY (MaHDTT)
);

CREATE TABLE THE_PHAT (
  MaTP CHAR(5) NOT NULL,
  MaCT CHAR(5) NOT NULL,
  LoaiThe NVARCHAR(255),
  MaTD CHAR(5),
  LiDo NVARCHAR(255),
  ThoiGian INT,
  PRIMARY KEY (MaTP)
);

CREATE TABLE LICH_TAP_LUYEN (
  MaLTL CHAR(5) NOT NULL,
  MaDB CHAR(4) NOT NULL,
  MaSVD CHAR(5) NOT NULL,
  ThoiGian NVARCHAR(255),
  NoiDung NVARCHAR(255),
  PRIMARY KEY (MaLTL)
);

CREATE TABLE TRAN_DAU (
  MaTD CHAR(5) NOT NULL,
  MaDoiNha CHAR(4) NOT NULL,
  MaDoiKhach CHAR(4) NOT NULL,
  KetQua NVARCHAR(255),
  ThoiGian INT,
  MaSVD CHAR(5),
  MaTT CHAR(4),
  PRIMARY KEY (MaTD)
);

CREATE TABLE BAN_THANG (
  ThoiGian INT,
  MaCT CHAR(5) NOT NULL,
  DBGhiBan CHAR(4) NOT NULL,
  DBThungLuoi CHAR(4) NOT NULL,
  MaTD CHAR(5) NOT NULL,
  PRIMARY KEY (ThoiGian,MaCT,MaTD)
);

ALTER TABLE DOI_BONG 
ADD FOREIGN KEY (MaSVD) REFERENCES DIA_DIEM(MaSVD);

ALTER TABLE DOI_BONG 
ADD FOREIGN KEY (MaHLV) REFERENCES HLV(MaHLV);

ALTER TABLE LICH_THI_DAU
ADD FOREIGN KEY (MaTD) REFERENCES TRAN_DAU(MaTD);

ALTER TABLE LICH_THI_DAU
ADD FOREIGN KEY (MaGD) REFERENCES GIAI_DAU(MaGD);

ALTER TABLE CAU_THU
ADD FOREIGN KEY (MaDB) REFERENCES DOI_BONG(MaDB);

ALTER TABLE NHA_TAI_TRO
ADD FOREIGN KEY (MaGD) REFERENCES GIAI_DAU(MaGD);

ALTER TABLE THE_PHAT
ADD FOREIGN KEY (MaCT) REFERENCES CAU_THU(MaCT);

ALTER TABLE THE_PHAT
ADD FOREIGN KEY (MaTD) REFERENCES TRAN_DAU(MaTD);

ALTER TABLE LICH_TAP_LUYEN
ADD FOREIGN KEY (MaDB) REFERENCES DOI_BONG(MaDB);

ALTER TABLE LICH_TAP_LUYEN
ADD FOREIGN KEY (MaSVD) REFERENCES DIA_DIEM(MaSVD);

ALTER TABLE TRAN_DAU
ADD FOREIGN KEY (MaDoiNha) REFERENCES DOI_BONG(MaDB);

ALTER TABLE TRAN_DAU
ADD FOREIGN KEY (MaDoiKhach) REFERENCES DOI_BONG(MaDB);

ALTER TABLE TRAN_DAU
ADD FOREIGN KEY (MaSVD) REFERENCES DIA_DIEM(MaSVD);

ALTER TABLE TRAN_DAU
ADD FOREIGN KEY (MaTT) REFERENCES TRONG_TAI(MaTT);

ALTER TABLE BAN_THANG
ADD FOREIGN KEY (MaCT) REFERENCES CAU_THU(MaCT);

ALTER TABLE BAN_THANG
ADD FOREIGN KEY (MaTD) REFERENCES TRAN_DAU(MaTD);